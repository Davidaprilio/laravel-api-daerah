class ApiDaerah{#option;elProvinsi;elKecamatan;elKabupaten;constructor(e={}){this.#option={baseUrl:e.baseUrl||window.location.origin,event:e.event||!0,placeholder:e.placeholder||!0,supportSelectValue:e.supportSelectValue||!1,idProvinsi:e.idProvinsi||"provinsi-select",idKecamatan:e.idKecamatan||"kecamatan-select",idKabupaten:e.idKabupaten||"kabupaten-select",provinsi:{id:e.provinsi?.id||null,value:e.provinsi?.value||"id",text:e.provinsi?.text||"name",selected:e.provinsi?.selected||null,endpoint:e.provinsi?.endpoint||"/api/provinsi"},kabupaten:{id:e.kabupaten?.id||null,value:e.kabupaten?.value||"id",text:e.kabupaten?.text||"name",selected:e.kabupaten?.selected||null,endpoint:e.kabupaten?.endpoint||"/api/kabupaten/:id"},kecamatan:{id:e.kecamatan?.id||null,value:e.kecamatan?.value||"id",text:e.kecamatan?.text||"name",selected:e.kecamatan?.selected||null,endpoint:e.kecamatan?.endpoint||"/api/kecamatan/:id"},enabled:{kabupaten:!1!==e.kabupaten?.id,kecamatan:!1!==e.kecamatan?.id}},"boolean"!=typeof this.#option.enabled.kabupaten&&(this.#option.enabled.kabupaten=!1!==e.idKabupaten),"boolean"!=typeof this.#option.enabled.kecamatan&&(this.#option.enabled.kecamatan=!1!==e.idKecamatan),this.elProvinsi=document.getElementById(this.#option.provinsi.id||this.#option.idProvinsi),this.elKecamatan=document.getElementById(this.#option.kecamatan.id||this.#option.idKecamatan),this.elKabupaten=document.getElementById(this.#option.kabupaten.id||this.#option.idKabupaten),this.#option.supportSelectValue&&(this.#option.provinsi.selected=this.#option.provinsi.selected||this.elProvinsi?.getAttribute("value")||null,this.#option.kecamatan.selected=this.#option.kecamatan.selected||this.elKecamatan?.getAttribute("value")||null,this.#option.kabupaten.selected=this.#option.kabupaten.selected||this.elKabupaten?.getAttribute("value")||null),this.#option.event&&this.#runEventSelect()}#getUrl(e){return this.#option.baseUrl+e}async getProvinsi(){return await this.#call(this.#option.provinsi.endpoint)}async getKabupaten(e){return await this.#call(this.#option.kabupaten.endpoint.replace(":id",e))}async getKecamatan(e){return await this.#call(this.#option.kecamatan.endpoint.replace(":id",e))}async renderProvinsi(e=null){var t=await this.getProvinsi(),a=this.getSelectProvinsiElement();this.#renderSelect(a,t,this.#option.provinsi.text,this.#option.provinsi.value,e)}async renderKabupaten(e=null,t=null){e=e||this.getSelectedProvinsiID();var e=await this.getKabupaten(e),a=this.getSelectKabupatenElement();this.#renderSelect(a,e,this.#option.kabupaten.text,this.#option.kabupaten.value,t)}async renderKecamatan(e=null,t=null){e=e||this.getSelectedKabupatenID();var e=await this.getKecamatan(e),a=this.getSelectKecamatanElement();this.#renderSelect(a,e,this.#option.kecamatan.text,this.#option.kecamatan.value,t)}getSelectProvinsiElement(){return this.#checkExistElement("Provinsi")}getSelectKabupatenElement(){return this.#checkExistElement("Kabupaten")}getSelectKecamatanElement(){return this.#checkExistElement("Kecamatan")}getSelectedProvinsiID(){return this.getSelectProvinsiElement().childNodes[this.elProvinsi.selectedIndex].dataset.id}getSelectedKecamatanID(){return this.getSelectKecamatanElement().childNodes[this.elKecamatan.selectedIndex].dataset.id}getSelectedKabupatenID(){return this.getSelectKabupatenElement().childNodes[this.elKabupaten.selectedIndex].dataset.id}#checkExistElement(t){try{if(null===this["el"+t])throw Error(`${t} Select with id="${this["el"+t]}" not found`)}catch(e){if(this.#option.enabled[t])throw e;throw Error(`Cannot get element because element ${t} off/disabled`)}return this["el"+t]}#renderSelect(t,e,a="name",n="id",i=null){t.innerHTML="",this.makePlaceholder(t),e.forEach(e=>{e=this.#createOption(e,e[a],n);t.appendChild(e)}),null!==i&&(t.value=i)}makePlaceholder(e,t=null,a=!0){var n;this.#option.placeholder&&(e.innerHTML="",(n=document.createElement("option")).innerText=t||e.getAttribute("placeholder")||"Pilih Lokasi",n.value=t,n.disabled=a,n.selected=!0,e.appendChild(n))}#createOption(e,t,a="id"){var n=document.createElement("option");return n.innerText=t,n.dataset.id=e.id,n.value=e[a]||null,n}async#call(e){return await(await fetch(this.#getUrl(e))).json()}async renderAllSelect(){this.#option.enabled.kabupaten&&this.makePlaceholder(this.getSelectKabupatenElement(),this.#option.kabupaten.selected,"string"!=typeof this.#option.kabupaten.selected),this.#option.enabled.kecamatan&&this.makePlaceholder(this.getSelectKecamatanElement(),this.#option.kecamatan.selected,"string"!=typeof this.#option.kecamatan.selected),await this.renderProvinsi(this.#option.provinsi.selected),console.log("Provinsi loaded"),this.#option.enabled.kabupaten&&this.#option.kabupaten.selected&&(await this.renderKabupaten(null,this.#option.kabupaten.selected),console.log("Kabupaten loaded")),this.#option.enabled.kecamatan&&this.#option.kecamatan.selected&&(await this.renderKecamatan(null,this.#option.kecamatan.selected),console.log("Kecamatan loaded"))}async#runEventSelect(){const e=this;this.makePlaceholder(this.getSelectProvinsiElement(),this.#option.provinsi.selected),this.#option.enabled.kabupaten&&(this.elProvinsi.addEventListener("change",function(){e.makePlaceholder(e.elKabupaten,"Memuat Kabupaten"),e.renderKabupaten(),e.makePlaceholder(e.elKecamatan)}),this.makePlaceholder(this.getSelectKabupatenElement(),this.#option.kabupaten.selected)),this.#option.enabled.kecamatan&&(this.elKabupaten.addEventListener("change",function(){e.makePlaceholder(e.elKecamatan,"Memuat Kecamatan"),e.renderKecamatan()}),this.makePlaceholder(this.getSelectKecamatanElement(),this.#option.kecamatan.selected)),this.renderAllSelect()}}