class ApiDaerah{#option;elProvinsi;elKecamatan;elKabupaten;constructor(e={}){this.#option={baseUrl:e.baseUrl||window.location.origin,event:e.event||!0,placeholder:e.placeholder||!0,supportSelectValue:e.supportSelectValue||!1,idProvinsi:e.idProvinsi||"provinsi-select",idKecamatan:e.idKecamatan||"kecamatan-select",idKabupaten:e.idKabupaten||"kabupaten-select",provinsi:{id:e.provinsi?.id||null,value:e.provinsi?.value||"id",text:e.provinsi?.text||"name",selected:e.provinsi?.selected||null,endpoint:e.provinsi?.endpoint||"/api/provinsi"},kabupaten:{id:e.kabupaten?.id||null,value:e.kabupaten?.value||"id",text:e.kabupaten?.text||"name",selected:e.kabupaten?.selected||null,endpoint:e.kabupaten?.endpoint||"/api/kabupaten/:id"},kecamatan:{id:e.kecamatan?.id||null,value:e.kecamatan?.value||"id",text:e.kecamatan?.text||"name",selected:e.kecamatan?.selected||null,endpoint:e.kecamatan?.endpoint||"/api/kecamatan/:id"}},this.elProvinsi=document.getElementById(this.#option.provinsi.id||this.#option.idProvinsi),this.elKecamatan=document.getElementById(this.#option.kecamatan.id||this.#option.idKecamatan),this.elKabupaten=document.getElementById(this.#option.kabupaten.id||this.#option.idKabupaten),this.#option.supportSelectValue&&(this.#option.provinsi.selected=this.#option.provinsi.selected||this.elProvinsi?.getAttribute("value")||null,this.#option.kecamatan.selected=this.#option.kecamatan.selected||this.elKecamatan?.getAttribute("value")||null,this.#option.kabupaten.selected=this.#option.kabupaten.selected||this.elKabupaten?.getAttribute("value")||null),this.#option.event&&this.#runEventSelect()}#getUrl(e){return this.#option.baseUrl+e}async getProvinsi(){return await this.#call(this.#option.provinsi.endpoint)}async getKabupaten(e){return await this.#call(this.#option.kabupaten.endpoint.replace(":id",e))}async getKecamatan(e){return await this.#call(this.#option.kecamatan.endpoint.replace(":id",e))}async renderProvinsi(e=null,t=null,a=null){var n=await this.getProvinsi(),i=this.getSelectProvinsiElement();a=a||this.#option.provinsi.selected,t=t||this.#option.provinsi.value,e=e||this.#option.provinsi.text,this.#renderSelect(i,n,e,t,a),null!=a&&(i.value=a)}async renderKabupaten(e,t=null,a=null,n=null){var e=await this.getKabupaten(e),i=this.getSelectKabupatenElement();n=n||this.#option.kabupaten.selected,a=a||this.#option.kabupaten.value,t=t||this.#option.kabupaten.text,this.#renderSelect(i,e,t,a,n),null!=n&&(i.value=n)}async renderKecamatan(e,t=null,a=null,n=null){var e=await this.getKecamatan(e),i=this.getSelectKecamatanElement();n=n||this.#option.kecamatan.selected,a=a||this.#option.kecamatan.value,t=t||this.#option.kecamatan.text,this.#renderSelect(i,e,t,a,n),null!=n&&(i.value=n)}getSelectProvinsiElement(){return this.#checkExistElement("Provinsi")}getSelectKabupatenElement(){return this.#checkExistElement("Kabupaten")}getSelectKecamatanElement(){return this.#checkExistElement("Kecamatan")}getSelectedProvinsiID(){return this.getSelectProvinsiElement().childNodes[this.elProvinsi.selectedIndex].dataset.id}getSelectedKecamatanID(){return this.getSelectKecamatanElement().childNodes[this.elKecamatan.selectedIndex].dataset.id}getSelectedKabupatenID(){return this.getSelectKabupatenElement().childNodes[this.elKabupaten.selectedIndex].dataset.id}#checkExistElement(e){if(null===this["el"+e])throw Error(`${e} Select with id="${this.#option["el"+e]}" not found`);return this["el"+e]}#renderSelect(t,e,a="name",n="id",i=null){t.innerHTML="",this.makePlaceholder(t),e.forEach(e=>{e=this.#createOption(e,e[a],n);t.appendChild(e)}),null!==i&&(t.value=i)}makePlaceholder(e,t=null){var a;this.#option.placeholder&&(e.innerHTML="",(a=document.createElement("option")).innerText=t||e.getAttribute("placeholder")||"Pilih Lokasi",a.disabled=!1,a.selected=!0,e.appendChild(a))}#createOption(e,t,a="id"){var n=document.createElement("option");return n.innerText=t,n.dataset.id=e.id,n.value=e[a]||null,n}async#call(e){return await(await fetch(this.#getUrl(e))).json()}#runEventSelect(){this.makePlaceholder(this.getSelectProvinsiElement()),this.renderProvinsi(),this.makePlaceholder(this.getSelectKabupatenElement()),this.makePlaceholder(this.getSelectKecamatanElement());const t=this;this.elProvinsi.addEventListener("change",function(){var e=t.getSelectedProvinsiID();t.makePlaceholder(t.elKabupaten,"Memuat Kabupaten"),t.renderKabupaten(e),t.makePlaceholder(t.elKecamatan)}),this.elKabupaten.addEventListener("change",function(){t.makePlaceholder(t.elKecamatan,"Memuat Kecamatan");var e=t.getSelectedKabupatenID();t.renderKecamatan(e)})}}