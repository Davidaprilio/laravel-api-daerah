class ApiDaerah{#e;elProvinsi;elKecamatan;elKabupaten;constructor(e={}){this.#e={baseUrl:e.baseUrl||window.location.origin,event:!1!==e.event,placeholder:!1!==e.placeholder,supportSelectValue:e.supportSelectValue||!1,idProvinsi:e.idProvinsi||"provinsi-select",idKecamatan:e.idKecamatan||"kecamatan-select",idKabupaten:e.idKabupaten||"kabupaten-select",provinsi:{id:e.provinsi?.id||null,value:e.provinsi?.value||"id",text:e.provinsi?.text||"name",selected:e.provinsi?.selected||null,endpoint:e.provinsi?.endpoint||"/api/provinsi"},kabupaten:{id:e.kabupaten?.id||null,value:e.kabupaten?.value||"id",text:e.kabupaten?.text||"name",selected:e.kabupaten?.selected||null,endpoint:e.kabupaten?.endpoint||"/api/kabupaten/:id"},kecamatan:{id:e.kecamatan?.id||null,value:e.kecamatan?.value||"id",text:e.kecamatan?.text||"name",selected:e.kecamatan?.selected||null,endpoint:e.kecamatan?.endpoint||"/api/kecamatan/:id"},enabled:{kabupaten:!1!==e.enabled?.kabupaten,kecamatan:!1!==e.enabled?.kecamatan}},"boolean"!=typeof this.#e.enabled.kabupaten&&(this.#e.enabled.kabupaten=!1!==e.idKabupaten),"boolean"!=typeof this.#e.enabled.kecamatan&&(this.#e.enabled.kecamatan=!1!==e.idKecamatan),this.elProvinsi=document.getElementById(this.#e.provinsi.id||this.#e.idProvinsi),this.elKecamatan=document.getElementById(this.#e.kecamatan.id||this.#e.idKecamatan),this.elKabupaten=document.getElementById(this.#e.kabupaten.id||this.#e.idKabupaten),this.#e.supportSelectValue&&(this.#e.provinsi.selected=this.#e.provinsi.selected||this.elProvinsi?.getAttribute("value")||null,this.#e.kecamatan.selected=this.#e.kecamatan.selected||this.elKecamatan?.getAttribute("value")||null,this.#e.kabupaten.selected=this.#e.kabupaten.selected||this.elKabupaten?.getAttribute("value")||null),this.#e.event&&this.#t()}#a(e){return this.#e.baseUrl+e}async getProvinsi(){return await this.#n(this.#e.provinsi.endpoint)}async getKabupaten(e){return await this.#n(this.#e.kabupaten.endpoint.replace(":id",e))}async getKecamatan(e){return await this.#n(this.#e.kecamatan.endpoint.replace(":id",e))}async renderProvinsi(e=null){const t=await this.getProvinsi(),a=this.getSelectProvinsiElement();this.#i(a,t,this.#e.provinsi.text,this.#e.provinsi.value,e)}async renderKabupaten(e=null,t=null){e=e||this.getSelectedProvinsiID();const a=await this.getKabupaten(e),n=this.getSelectKabupatenElement();this.#i(n,a,this.#e.kabupaten.text,this.#e.kabupaten.value,t)}async renderKecamatan(e=null,t=null){e=e||this.getSelectedKabupatenID();const a=await this.getKecamatan(e),n=this.getSelectKecamatanElement();this.#i(n,a,this.#e.kecamatan.text,this.#e.kecamatan.value,t)}getSelectProvinsiElement(){return this.#l("Provinsi")}getSelectKabupatenElement(){return this.#l("Kabupaten")}getSelectKecamatanElement(){return this.#l("Kecamatan")}getSelectedProvinsiID(){return this.getSelectProvinsiElement().childNodes[this.elProvinsi.selectedIndex].dataset.id}getSelectedKecamatanID(){return this.getSelectKecamatanElement().childNodes[this.elKecamatan.selectedIndex].dataset.id}getSelectedKabupatenID(){return this.getSelectKabupatenElement().childNodes[this.elKabupaten.selectedIndex].dataset.id}#l(e){try{if(null===this[`el${e}`])throw Error(`${e} Select with id="${this[`el${e}`]}" not found`)}catch(t){if(this.#e.enabled[e])throw t;throw Error(`Cannot get element because element ${e} off/disabled`)}return this[`el${e}`]}#i(e,t,a="name",n="id",i=null){e.innerHTML="",this.makePlaceholder(e),t.forEach((t=>{const i=this.#s(t,t[a],n);e.appendChild(i)})),null!==i&&(e.value=i)}makePlaceholder(e,t=null,a=!0){if(this.#e.placeholder){e.innerHTML="";const n=document.createElement("option");n.innerText=t||e.getAttribute("placeholder")||"Pilih Lokasi",n.value=t,n.disabled=a,n.selected=!0,e.appendChild(n)}}#s(e,t,a="id"){const n=document.createElement("option");return n.innerText=t,n.dataset.id=e.id,n.value=e[a]||null,n}async#n(e){const t=await fetch(this.#a(e));return await t.json()}async renderAllSelect(e=!1){this.#e.enabled.kabupaten&&this.makePlaceholder(this.getSelectKabupatenElement(),e?this.#e.kabupaten.selected:null,"string"!=typeof this.#e.kabupaten.selected),this.#e.enabled.kecamatan&&this.makePlaceholder(this.getSelectKecamatanElement(),e?this.#e.kecamatan.selected:null,"string"!=typeof this.#e.kecamatan.selected),await this.renderProvinsi(e?this.#e.provinsi.selected:null),this.#e.enabled.kabupaten&&e&&this.#e.kabupaten.selected&&await this.renderKabupaten(null,this.#e.kabupaten.selected),this.#e.enabled.kecamatan&&e&&this.#e.kecamatan.selected&&await this.renderKecamatan(null,this.#e.kecamatan.selected)}async#t(){const e=this;if(this.makePlaceholder(this.getSelectProvinsiElement(),this.#e.provinsi.selected),this.#e.enabled.kabupaten){const t=this.#e.enabled.kecamatan;function a(){e.makePlaceholder(e.elKabupaten,"Memuat Kabupaten"),e.renderKabupaten(),t&&e.makePlaceholder(e.elKecamatan)}$?$(this.elProvinsi).on("change",a):this.elProvinsi.addEventListener("change",a),this.makePlaceholder(this.getSelectKabupatenElement(),this.#e.kabupaten.selected)}if(this.#e.enabled.kecamatan){function n(){e.makePlaceholder(e.elKecamatan,"Memuat Kecamatan"),e.renderKecamatan()}$?$(this.elKabupaten).on("change",n):this.elKabupaten.addEventListener("change",n),this.makePlaceholder(this.getSelectKecamatanElement(),this.#e.kecamatan.selected)}this.renderAllSelect(!0)}}